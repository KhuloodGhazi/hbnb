<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Place Details</title>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Montserrat', sans-serif; margin:0; background:#f9f9f9; color:#333; }
    a { text-decoration: none; color: inherit; }
    header { display: flex; justify-content: space-between; align-items: center; padding: 15px 50px; background: white; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
    header .logo { font-weight: bold; font-size: 24px; }
    header nav { display: flex; align-items: center; gap: 20px; }
    header nav a { font-weight: 500; color: #333; }
    header nav a:hover { color: #007BFF; }
    .login-button { padding: 8px 20px; border-radius: 20px; background: #007BFF; color: white !important; font-weight: 500;}
    .login-button:hover { background: #0056b3; }
    .container { max-width:1000px; margin:2rem auto; background:white; border-radius:12px; overflow:hidden; box-shadow:0 4px 12px rgba(0,0,0,0.1); }
    .place-img { width:100%; height:400px; object-fit:cover; }
    .content { padding:2rem; }
    .content h1 { margin:0; font-family:'DM Sans'; font-size:2rem; }
    .price { font-size:1.2rem; font-weight:bold; color:#007BFF; margin-top:.5rem; }
    .amenities span { display:inline-block; margin:0.3rem; background:#007BFF; color: #f7f7f7; padding:0.4rem 0.8rem; border-radius:6px; font-size:0.85rem; }
    .reviews { margin-top:2rem; }
    .review { background:#f7f7f7; padding:1rem; border-radius:8px; margin-bottom:1rem; }
    footer {text-align: center; padding: 20px; background: #f8f8f8; margin-top: 40px; font-size: 14px; color: #666; margin-top: 8px; }
  </style>
</head>
<body>
  <header>
    <a href="index.html"><div class="logo">HBNB</div></a>
    <nav>
      <a href="#">Home</a>
      <a href="#">Contact</a>
      <a href="#">Support</a>
      <a href="#">Location</a>
      <a id="login-link" href="login.html" class="login-button">Login</a>
    </nav>
  </header>

  <main>
    <div class="container">
      <img id="place-img" class="place-img" src="" alt="Place image">

      <div class="content">
        <h1 id="place-title">Loading...</h1>
        <p class="price" id="place-price"></p>
        <p id="place-description"></p>
        <p><strong>Host:</strong> <span id="place-host"></span></p>
        <p><strong>Location:</strong> <span id="place-location"></span></p>

        <h3>Amenities</h3>
        <div class="amenities" id="place-amenities"></div>
        <hr style="color: #ffffff; margin-top: 2rem;">

        <div class="reviews">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem; padding-top: 2rem;">
            <h3 style="margin: 0;">Reviews</h3>
            <a id="add-review-btn" href="add_review.html" 
            class="details-button" 
            style="background:#007BFF;color:white;padding:0.6rem 1rem;border-radius:6px;text-decoration:none; margin-left:1rem;">
            Write a Review
          </a>
        </div>
        <div id="reviews-container"></div>
      </div>

      </div>
    </div>
  </main>

  <footer>
    <p>&copy; 2025 HBNB. All rights reserved.</p>
  </footer>

  <script>
    async function loadPlace() {
      // get place id from URL (?id=lx1)
      const urlParams = new URLSearchParams(window.location.search);
      const placeId = urlParams.get("id") || "lx1";

      try {
        const res = await fetch(`http://127.0.0.1:5000/api/v1/places/${placeId}`);
        const place = await res.json();

        document.getElementById("place-title").textContent = place.title;
        document.getElementById("place-price").textContent = "$" + place.price.toLocaleString();
        document.getElementById("place-description").textContent = place.description;
        document.getElementById("place-host").textContent = place.host;
        document.getElementById("place-location").textContent = place.city + ", " + place.country;

        // Image
        if (place.images && place.images.length > 0) {
          document.getElementById("place-img").src = place.images[0];
        } else {
          document.getElementById("place-img").src = "images/default.jpg";
        }

        // Amenities
        const amDiv = document.getElementById("place-amenities");
        amDiv.innerHTML = "";
        place.amenities.forEach(am => {
          const span = document.createElement("span");
          span.textContent = am;
          amDiv.appendChild(span);
        });

        // Reviews
        const revDiv = document.getElementById("reviews-container");
        revDiv.innerHTML = "";
        if (place.reviews && place.reviews.length > 0) {
          place.reviews.forEach(r => {
            const div = document.createElement("div");
            div.className = "review";
            div.innerHTML = `<strong>${r.user}</strong> ‚≠ê${r.rating}<br>${r.comment}`;
            revDiv.appendChild(div);
          });
        } else {
          revDiv.innerHTML = "<p>No reviews yet.</p>";
        }

      } catch (err) {
        console.error("Error loading place:", err);
      }
    }

    loadPlace();
  </script>
</body>
</html>
